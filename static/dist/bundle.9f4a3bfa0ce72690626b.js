"use strict";(self.webpackChunkdepot=self.webpackChunkdepot||[]).push([[766],{9385:function(e,t,a){a.r(t);var l=a(6540),n=a(1083);t.default=()=>{const[e,t]=(0,l.useState)({name:"",text:"",photo:""}),[a,r]=(0,l.useState)(""),[o,s]=(0,l.useState)(""),[m,c]=(0,l.useState)([]),[i,_]=(0,l.useState)(""),[p,u]=(0,l.useState)({id:"",title:"",link:"",text:"",photo:""}),[d,f]=(0,l.useState)(""),[g,E]=(0,l.useState)("");(0,l.useEffect)((()=>{h(),b()}),[]);const h=()=>{n.A.get("/api/manager").then((e=>t(e.data))).catch((e=>console.error("Error fetching manager data:",e)))},b=()=>{n.A.get("/api/tenants").then((e=>c(e.data))).catch((e=>console.error("Error fetching tenants list:",e)))},N=a=>{const{name:l,value:n}=a.target;t({...e,[l]:n})},v=e=>{const{name:t,value:a}=e.target;u({...p,[t]:a})},k=async e=>{const t=new FormData;t.append("file",e);for(let e of t.entries())console.log(e[0]+", "+e[1]);try{const e=await n.A.post("/api/upload",t,{headers:{"Content-Type":"multipart/form-data"}});return console.log(e.data),console.log(e.data.result),console.log(e.data.result.variants),e.data.result.variants[0]}catch(e){throw console.error("Ошибка при загрузке фотографии:",e),new Error("Ошибка при загрузке фотографии")}},y=(e,t)=>{const a=e.target.files[0];a&&t((e=>({...e,photoFile:a})))},x=(e,t)=>{t(e),setTimeout((()=>{t("")}),5e3)};return l.createElement("div",{className:"editor"},l.createElement("div",{className:"editor__block"},l.createElement("h2",{className:"editor__title"},"Блок Управляющий"),l.createElement("form",{className:"form form--admin",onSubmit:async a=>{a.preventDefault();try{if(e.photoFile){const a=await k(e.photoFile);console.log("here",a),t((e=>({...e,photo:a})))}await n.A.post("/api/manager/update",e),x("Данные успешно сохранены",r)}catch(e){x("Ошибка при сохранении данных",s)}}},l.createElement("div",{className:"form__group"},l.createElement("label",{className:"form__label"},"Изменить ФИО"),l.createElement("input",{className:"form__input form__input--black",type:"text",name:"name",value:e.name,onChange:N,placeholder:"Введите ФИО"})),l.createElement("div",{className:"form__group"},l.createElement("label",{className:"form__label"},"Изменить текст"),l.createElement("textarea",{className:"form__input form__input--black",name:"text",rows:"5",value:e.text,onChange:N,placeholder:"Введите текст"})),l.createElement("div",{className:"form__group"},l.createElement("label",{className:"form__label"},"Изменить фотографию"),l.createElement("input",{className:"form__input form__input--black",type:"file",accept:"image/*",onChange:e=>y(e,t)})),l.createElement("button",{className:"button animate--pulse",type:"submit"},"Сохранить"),a&&l.createElement("div",{className:"editor__message editor__message--green"},a),o&&l.createElement("div",{className:"editor__message editor__message--red"},o))),l.createElement("div",{className:"editor__block"},l.createElement("h2",{className:"editor__title"},"Блок Арендаторы"),l.createElement("form",{className:"form form--admin",onSubmit:async e=>{e.preventDefault();try{if(p.photoFile){const e=await k(p.photoFile);u((t=>({...t,photo:e})))}""===i?await n.A.put("/api/tenants/create",p):await n.A.post("/api/tenants/update",p),x("Данные успешно сохранены",f),b()}catch(e){x("Ошибка при сохранении данных",E)}}},l.createElement("div",{className:"form__group"},l.createElement("label",{className:"form__label"},"Выбрать арендатора"),l.createElement("select",{className:"form__input form__input--black",value:i,onChange:e=>{const t=e.target.value;if(_(t),""===t)u({id:"",title:"",link:"",text:"",photo:""});else{const e=m.find((e=>e.id===t));u(e)}}},l.createElement("option",{value:""},"Не выбрано"),m.map((e=>l.createElement("option",{key:e.id,value:e.id},e.name))))),l.createElement("div",{className:"form__group"},l.createElement("label",{className:"form__label"},"Изменить заголовок"),l.createElement("input",{className:"form__input form__input--black",type:"text",name:"title",value:p.title,onChange:v,placeholder:"Введите заголовок"})),l.createElement("div",{className:"form__group"},l.createElement("label",{className:"form__label"},"Изменить ссылку"),l.createElement("input",{className:"form__input form__input--black",type:"text",name:"link",value:p.link,onChange:v,placeholder:"Введите ссылку"})),l.createElement("div",{className:"form__group"},l.createElement("label",{className:"form__label"},"Изменить текст"),l.createElement("textarea",{className:"form__input form__input--black",name:"text",rows:"5",value:p.text,onChange:v,placeholder:"Введите текст"})),l.createElement("div",{className:"form__group"},l.createElement("label",{className:"form__label"},"Изменить фотографию"),l.createElement("input",{className:"form__input form__input--black",type:"file",accept:"image/*",onChange:e=>y(e,u)})),l.createElement("div",{className:"flex flex--sb"},l.createElement("button",{className:"button animate--pulse",type:"submit"},"Сохранить"),l.createElement("button",{className:"button button--grey animate--pulse",type:"button",onClick:async()=>{if(""!==i)try{await n.A.delete(`/api/tenants/delete/${i}`),x("Данные успешно удалены",f),u({id:"",title:"",link:"",text:"",photo:""}),_(""),b()}catch(e){x("Ошибка при удалении данных",E)}}},"Удалить")),d&&l.createElement("div",{className:"editor__message editor__message--green"},d),g&&l.createElement("div",{className:"editor__message editor__message--red"},g))))}}}]);