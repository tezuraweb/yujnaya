"use strict";(self.webpackChunkdepot=self.webpackChunkdepot||[]).push([[116],{7735:function(e,t,a){a.r(t);var o=a(6540),r=a(1083),s=a(6525);t.default=()=>{const[e,t]=(0,o.useState)([]),[a,n]=(0,o.useState)(0),[l,c]=(0,o.useState)(1),[m,u]=(0,o.useState)(1),[i,p]=(0,o.useState)(null),[d,f]=(0,o.useState)(!1),[h,g]=(0,o.useState)(""),[_,E]=(0,o.useState)(null),[b,k]=(0,o.useState)(null);(0,o.useEffect)((()=>{0==e.length&&S(0,6)}),[e]),(0,o.useEffect)((()=>{u(Math.ceil(a/6))}),[6,a]);const S=async(a,o)=>{if(e.length>a)c(Math.floor(a/6)+1);else try{const e=await r.A.post("/api/search",{startIdx:a,endIdx:o});if(n(e.data.total),u(Math.ceil(e.data.total/6)),0===e.data.total)return;t((t=>[...t,...e.data.rows])),c(Math.floor(a/6)+1)}catch(e){console.error("Error fetching data:",e)}};return o.createElement(o.Fragment,null,o.createElement(s.A,{modifier:"promotions",cards:e.slice(6*(l-1),6*l),currentPage:l,totalPages:m,onPageChange:e=>{const t=6*(e-1),a=6*e;p(null),S(t,a)},totalCards:a,setActiveCardOuter:t=>{const a=6*(l-1)+t;console.log(e[a]),p(a),f(e[a]?.promotion),g(e[a]?.promotion_price)}}),null!==i&&o.createElement("form",{className:"form form--small",onSubmit:async t=>{t.preventDefault();try{const t=e[i].id;await r.A.post("/api/promotions",{id:t,promotion:d,price:h})}catch(e){console.error("Error updating promotions:",e)}}},o.createElement("div",{className:"form__group"},o.createElement("input",{type:"checkbox",name:"promotions",id:"promotionCheckbox",checked:d,onChange:e=>f(e.target.checked),className:"form__checkbox"}),o.createElement("label",{className:"form__label",htmlFor:"promotionCheckbox"},"Акции")),o.createElement("input",{type:"text",name:"telegramUsername",placeholder:"Имя пользователя Telegram",value:h,onChange:e=>g(e.target.value),className:"form__input",required:d}),o.createElement("button",{type:"submit",className:"form__button button"},"Сохранить"),_&&o.createElement("div",{className:"form__message form__message--red"},_),b&&o.createElement("div",{className:"form__message form__message--green"},b)))}}}]);